

<!DOCTYPE html>
<html class="no-js" lang="en">
    
    

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>
             Native protocol layer | Scylla Docs 
        </title>
        <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />
        <link rel="icon" href="../../../_static/img/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="../../../_static/img/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" href="../../../_static/img/favicon-228x228.png" sizes="192x192" />
        <link rel="apple-touch-icon" href="../../../_static/img/favicon-228x228.png" />
        <meta name="msapplication-TileImage" href="../../../_static/img/favicon-228x228.png" />

        
            
        

        
            
            <link rel="canonical" href="https://java-driver.docs.scylladb.com/stable/manual/developer/native_protocol/"/>
        

        <link rel="author" href="mailto:info@scylladb.com" />

        
            
        <!-- increase expertrec loading priority-->
        <link rel="dns-prefetch" href="https://cse.expertrec.com">

        <!-- increase font loading priority -->
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="preload" as="style"
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- async CSS -->
        <link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');"
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- no-JS fallback -->
        <noscript>
            <link rel="stylesheet"
                href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />
        </noscript>
        
            
                <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../../../_static/css/main.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_collapse.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
            
        
    
        
        
            

        <script type="text/javascript" id="documentation_options" data-url_root="../../../"
            src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/js/runtime.bundle.js"></script>
        <script type="text/javascript" src="../../../_static/js/main.bundle.js"></script>
        
            
                <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
            
        
            
        
            
                <script src="../../../_static/underscore.js"></script>
            
        
            
                <script src="../../../_static/doctools.js"></script>
            
        
            
                <script src="../../../_static/clipboard.min.js"></script>
            
        
            
                <script src="../../../_static/copybutton.js"></script>
            
        
    
            <!-- Google Tag Manager -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-T8P2JP");
</script>
<!-- End Google Tag Manager -->

<!-- Expertrec -->
<script>
    var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
    var ci_search = document.createElement("script");
    ci_search.type = "text/javascript";
    ci_search.async = true;
    ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ci_search, s);
</script>
<!-- End Expertrec -->
        
        <!-- Font Awesome -->
        <script src="https://kit.fontawesome.com/b1870adf6a.js" crossorigin="anonymous"></script>
        <!-- End Font Awesome -->
    </head>

    <body>
        
        <header class="header">
    <div class="header-logo">
        <a class="header-logo__img" href="https://scylladb.com/">
            <img src="../../../_static/img/logo-docs.svg" alt="Scylla Documentation Logo" />
        </a>
        <span class="header-logo__bar"></span>
        <a class="header-logo__text" href="https://docs.scylladb.com/">
            Documentation
        </a>
    </div>
    <div class="header-navigation">
        <ul class="dropdown menu scylla-dropdown scylla-dropdown--header" data-dropdown-menu>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Server
                    <i class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--about-us"></i>
                            Scylla Open Source
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--enterprise"></i>Scylla Enterprise
                        </a>
                    </li>
                    <li>
                        <a href="https://scylla.docs.scylladb.com/stable/alternator/alternator.html">
                            <i class="scylla-icon scylla-icon--overview"></i>
                            Scylla Alternator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Cloud <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://cloud.scylladb.com/">
                            <i class="scylla-icon scylla-icon--cloud"></i>Scylla Cloud</a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">
                            <i class="scylla-icon scylla-icon--cloud-docs"></i>Scylla Cloud
                            Docs</a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Tools <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://manager.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--manager"></i>Scylla Manager</a>
                    </li>
                    <li>
                        <a href="https://monitoring.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--monitoring"></i>Scylla
                            Monitoring Stack</a>
                    </li>
                    <li>
                        <a href="https://operator.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--operator"></i>Scylla Operator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Drivers <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/cql-drivers/">
                            <i class="scylla-icon scylla-icon--nsql-guides"></i>CQL Drivers
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/dynamo-drivers/">
                            <i class="scylla-icon scylla-icon--overview"></i>DynamoDB Drivers
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
        <div class="header-button">
            <a href="https://www.scylladb.com/download/" class="button">Download</a>
        </div>
    </div>
    <div class="header-search-box">
        <div class="search-box">
            <ci-search></ci-search>
        </div>
    </div>
    <div class="side-nav-toggle" data-toggle="side-nav">
    <div class="side-nav-toggle__button">
        <img src="../../../_static/img/menu.svg" alt="Menu" />
    </div>
</div>
</header>
        <section
            class="layout  layout--sidebar layout--has-secondary-sidebar ">
            <div class="content large-order-2">
                
                    
    <div class="admonition caution">
        <p class="admonition-title">Caution</p>
        <p>
            
                You're viewing documentation for a previous version of Scylla Java Driver.
            
            <a href="../../../../stable/index.html">Switch to the latest stable version.</a>
        </p>
    </div>

                
                
                    <div class="pre-content">
                        <div class="breadcrumbs">
    <span class="bread__item">
        <a href="https://java-driver.docs.scylladb.com"
            class="bread__highlight">
            <i class="fas fa-home"></i> Scylla Java Driver
        </a>
    </span>
    
        <span class="bread__item">
            <a href="../../index.html">
                Manual
            </a>
        </span>
    
        <span class="bread__item">
            <a href="../index.html">
                Developer docs
            </a>
        </span>
    
    <span class="bread__item bread__item--last">Native protocol layer</span>
</div>
                    </div>
                
                <section id="native-protocol-layer">
<h1>Native protocol layer<a class="headerlink" href="#native-protocol-layer" title="Permalink to this headline">¶</a></h1>
<p>The native protocol layer encodes protocol messages into binary, before they are sent over the
network.</p>
<p>This part of the code lives in its own project:
<a class="reference external" href="https://github.com/datastax/native-protocol">native-protocol</a>. We extracted it to make it reusable
(<a class="reference external" href="https://github.com/datastax/simulacron">Simulacron</a> also uses it).</p>
<p>The protocol specifications are available in
<a class="reference external" href="https://github.com/datastax/native-protocol/tree/1.x/src/main/resources">native-protocol/src/main/resources</a>.
These files originally come from Cassandra, we copy them over for easy access. Note that, if the
latest version is a beta (this is the case for v5 at the time of writing – September 2019), the
specification might not be up to date. Always compare with the latest revision in
<a class="reference external" href="https://github.com/apache/cassandra/tree/trunk/doc">cassandra/doc</a>.</p>
<p>For a broad overview of how protocol types are used in the driver, let’s step through an example:</p>
<ul class="simple">
<li><p>the user calls <code class="docutils literal notranslate"><span class="pre">session.execute()</span></code> with a <code class="docutils literal notranslate"><span class="pre">SimpleStatement</span></code>. The protocol message for a
non-prepared request is <code class="docutils literal notranslate"><span class="pre">QUERY</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CqlRequestHandler</span></code> uses <code class="docutils literal notranslate"><span class="pre">Conversions.toMessage</span></code> to convert the statement into a
<code class="docutils literal notranslate"><span class="pre">c.d.o.protocol.internal.request.Query</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">InflightHandler.write</span></code> assigns a stream id to that message, and wraps it into a
<code class="docutils literal notranslate"><span class="pre">c.d.o.protocol.internal.Frame</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FrameEncoder</span></code> uses <code class="docutils literal notranslate"><span class="pre">c.d.o.protocol.internal.FrameCodec</span></code> to convert the frame to binary.</p></li>
</ul>
<p>(All types prefixed with <code class="docutils literal notranslate"><span class="pre">c.d.o.protocol.internal</span></code> belong to the native-protocol project.)</p>
<p>A similar process happens on the response path: decode the incoming binary payload into a protocol
message, then convert the message into higher-level driver objects: <code class="docutils literal notranslate"><span class="pre">ResultSet</span></code>, <code class="docutils literal notranslate"><span class="pre">ExecutionInfo</span></code>,
etc.</p>
<section id="native-protocol-types">
<h2>Native protocol types<a class="headerlink" href="#native-protocol-types" title="Permalink to this headline">¶</a></h2>
<section id="messages">
<h3>Messages<a class="headerlink" href="#messages" title="Permalink to this headline">¶</a></h3>
<p>Every protocol message is identified by an opcode, and has a corresponding <code class="docutils literal notranslate"><span class="pre">Message</span></code> subclass.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">Frame</span></code> wraps a message to add metadata, such as the protocol version and stream id.</p>
<div class="highlight-ditaa notranslate"><div class="highlight"><pre><span></span>+-------+ contains +------------+
<span class="p">|</span> Frame +---------&gt;+ Message    +
+-------+          +------------+
                   <span class="p">|</span> int opcode <span class="p">|</span>
                   +--+---------+
                      <span class="p">|</span>
                      <span class="p">|</span>    +---------+
                      +----+ Query   <span class="p">|</span>
                      <span class="p">|</span>    +---------+
                      <span class="p">|</span>
                      <span class="p">|</span>    +---------+
                      +----+ Execute <span class="p">|</span>
                      <span class="p">|</span>    +---------+
                      <span class="p">|</span>
                      <span class="p">|</span>    +---------+
                      +----+ Rows    <span class="p">|</span>
                           +---------+
                           
                           etc.
</pre></div>
</div>
<p>All value classes are immutable, but for efficiency they don’t make defensive copies of their
fields. If these fields are mutable (for example collections), they shouldn’t be modified after
creating a message instance.</p>
<p>The code makes very few assumptions about how the messages will be used. Data is often represented
in the most simple way. For example, <code class="docutils literal notranslate"><span class="pre">ProtocolConstants</span></code> uses simple integer constants to represent
protocol codes (enums wouldn’t work at that level, because we need to add new codes in the DSE
driver); the driver generally rewraps them in more type-safe structures before exposing them to
higher-level layers.</p>
</section>
<section id="encoding-decoding">
<h3>Encoding/decoding<a class="headerlink" href="#encoding-decoding" title="Permalink to this headline">¶</a></h3>
<p>For every message, there is a corresponding <code class="docutils literal notranslate"><span class="pre">Message.Codec</span></code> for encoding and decoding. A
<code class="docutils literal notranslate"><span class="pre">FrameCodec</span></code> relies on a set of message codecs, for one or more protocol versions. Given an incoming
frame, it looks up the right message codec to use, based on the protocol version and opcode.
Optionally, it compresses frame bodies with a <code class="docutils literal notranslate"><span class="pre">Compressor</span></code>.</p>
<div class="highlight-ditaa notranslate"><div class="highlight"><pre><span></span>+-----------------+                +-------------------+
<span class="p">|</span> FrameCodec<span class="o">[</span>B<span class="o">]</span>   +----------------+ PrimitiveCodec<span class="o">[</span>B<span class="o">]</span> <span class="p">|</span>
+-----------------+                +-------------------+
<span class="p">|</span> B encode<span class="o">(</span>Frame<span class="o">)</span> <span class="p">|</span>
<span class="p">|</span> Frame decode<span class="o">(</span>B<span class="o">)</span> +-------+        +---------------+
+------+----------+       +--------+ Compressor<span class="o">[</span>B<span class="o">]</span> <span class="p">|</span>
       <span class="p">|</span>                           +---------------+
       <span class="p">|</span>
       <span class="p">|</span>                           +-------------------+
       +---------------------------+ Message.Codec     <span class="p">|</span>
           <span class="m">1</span> codec per opcode      +-------------------+
           and protocol version    <span class="p">|</span> B encode<span class="o">(</span>Message<span class="o">)</span> <span class="p">|</span>
                                   <span class="p">|</span> Message decode<span class="o">(</span>B<span class="o">)</span> <span class="p">|</span>
                                   +-------------------+
</pre></div>
</div>
<p>Most of the time, you’ll want to use the full set of message codecs for a given protocol version.
<code class="docutils literal notranslate"><span class="pre">CodecGroup</span></code> provides a convenient way to register multiple codecs at once. The project provides
default implementations for all supported protocol version, both for clients like the driver (e.g.
encode <code class="docutils literal notranslate"><span class="pre">QUERY</span></code>, decode <code class="docutils literal notranslate"><span class="pre">RESULT</span></code>), or servers like Simulacron (decode <code class="docutils literal notranslate"><span class="pre">QUERY</span></code> encode <code class="docutils literal notranslate"><span class="pre">RESULT</span></code>).</p>
<div class="highlight-ditaa notranslate"><div class="highlight"><pre><span></span>+-------------+
<span class="p">|</span>  CodecGroup <span class="p">|</span>
+------+------+
       <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       +----+ ProtocolV3ClientCodecs <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       +----+ ProtocolV3ServerCodecs <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       +----+ ProtocolV4ClientCodecs <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       +----+ ProtocolV4ClientCodecs <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       +----+ ProtocolV5ClientCodecs <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       <span class="p">|</span>
       <span class="p">|</span>    +------------------------+
       +----+ ProtocolV5ClientCodecs <span class="p">|</span>
            +------------------------+
</pre></div>
</div>
<p>The native protocol layer is agnostic to the actual binary representation. In the driver, this
happens to be a Netty <code class="docutils literal notranslate"><span class="pre">ByteBuf</span></code>, but the encoding logic doesn’t need to be aware of that. This is
expressed by the type parameter <code class="docutils literal notranslate"><span class="pre">B</span></code> in <code class="docutils literal notranslate"><span class="pre">FrameCodec&lt;B&gt;</span></code>. <code class="docutils literal notranslate"><span class="pre">PrimitiveCodec&lt;B&gt;</span></code> abstracts the basic
primitives to work with a <code class="docutils literal notranslate"><span class="pre">B</span></code>: how to create an instance, read and write data to it, etc.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">PrimitiveCodec</span><span class="o">&lt;</span><span class="n">B</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="n">B</span> <span class="nf">allocate</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">);</span>
  <span class="kt">int</span> <span class="nf">readInt</span><span class="o">(</span><span class="n">B</span> <span class="n">source</span><span class="o">);</span>
  <span class="kt">void</span> <span class="nf">writeInt</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="n">B</span> <span class="n">dest</span><span class="o">);</span>
  <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Everything else builds upon those primitives. By just switching the <code class="docutils literal notranslate"><span class="pre">PrimitiveCodec</span></code> implementation,
the whole protocol layer could be reused with a different type, such as <code class="docutils literal notranslate"><span class="pre">byte[]</span></code>.</p>
<p>In summary, to initialize a <code class="docutils literal notranslate"><span class="pre">FrameCodec</span></code>, you need:</p>
<ul class="simple">
<li><p>a <code class="docutils literal notranslate"><span class="pre">PrimitiveCodec</span></code>;</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">Compressor</span></code> (optional);</p></li>
<li><p>one or more <code class="docutils literal notranslate"><span class="pre">CodecGroup</span></code>s.</p></li>
</ul>
</section>
</section>
<section id="integration-in-the-driver">
<h2>Integration in the driver<a class="headerlink" href="#integration-in-the-driver" title="Permalink to this headline">¶</a></h2>
<p>The driver initializes its <code class="docutils literal notranslate"><span class="pre">FrameCodec</span></code> in <code class="docutils literal notranslate"><span class="pre">DefaultDriverContext.buildFrameCodec()</span></code>.</p>
<ul class="simple">
<li><p>the primitive codec is <code class="docutils literal notranslate"><span class="pre">ByteBufPrimitiveCodec</span></code>, which implements the basic primitives for Netty’s
<code class="docutils literal notranslate"><span class="pre">ByteBuf</span></code>;</p></li>
<li><p>the compressor comes from <code class="docutils literal notranslate"><span class="pre">DefaultDriverContext.buildCompressor()</span></code>, which determines the
implementation from the configuration;</p></li>
<li><p>it is built with <code class="docutils literal notranslate"><span class="pre">FrameCodec.defaultClient</span></code>, which is a shortcut to use the default client groups:
<code class="docutils literal notranslate"><span class="pre">ProtocolV3ClientCodecs</span></code>, <code class="docutils literal notranslate"><span class="pre">ProtocolV4ClientCodecs</span></code> and <code class="docutils literal notranslate"><span class="pre">ProtocolV5ClientCodecs</span></code>.</p></li>
</ul>
</section>
<section id="extension-points">
<h2>Extension points<a class="headerlink" href="#extension-points" title="Permalink to this headline">¶</a></h2>
<p>The default frame codec can be replaced by <a class="reference external" href="../common/context/#overriding-a-context-component">extending the
context</a> to override <code class="docutils literal notranslate"><span class="pre">buildFrameCodec</span></code>. This
can be used to add or remove a protocol version, or replace a particular codec.</p>
<p>If protocol versions change, <code class="docutils literal notranslate"><span class="pre">ProtocolVersionRegistry</span></code> will likely be affected as well.</p>
<p>Also, depending on the nature of the protocol changes, the driver’s <a class="reference external" href="../request_execution/#request-processors">request
processors</a> might require some adjustments: either replace
them, or introduce separate ones (possibly with new <code class="docutils literal notranslate"><span class="pre">executeXxx()</span></code> methods on a custom session
interface).</p>
</section>
</section>

                
                    <div class="post-content"><div class="content-navigation">
    <div class="navigation navigation--prev">
        
            <a class="navigation__link" href="../common/event_bus/index.html">
                <button class="navigation__button">
                    <i class="scylla-icon scylla-icon--chevron-left"></i>
                </button>
                <div class="navigation__title">
                    <span class="colored">PREVIOUS</span> <br />Event bus
                </div>
            </a>
        
    </div>
    <div class="navigation navigation--next">
        
            <a class="navigation__link" href="../netty_pipeline/index.html">
                <div class="navigation__title">
                    <span class="colored">NEXT</span> <br />Netty pipeline
                </div>
                <button class="navigation__button">
                    <i class="scylla-icon scylla-icon--chevron-right"></i>
                </button>
            </a>
        
    </div>
</div></div>
                
            </div>
            <div class="sidebar-left  large-order-1">
                
                    
                        <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
    <button class="collapsible-button">
        <i class="scylla-icon scylla-icon--chevron-left"></i>
    </button>
    <div class="side-nav-content">
        <div class="side-nav__search">
            <div class="search-box">
                <ci-search></ci-search>
            </div>
        </div>
        <div class="side-nav__versions">
    <ul class="dropdown menu scylla-dropdown scylla-dropdown--versions" data-dropdown-menu>
        <li class="scylla-dropdown__item">
            <a class="scylla-dropdown__title" href="#">
                
                    4.11.1.x
                
                <i class="chevron scylla-icon scylla-icon--chevron-right"></i>
            </a>
            <ul class="menu scylla-dropdown__content">
                
                    
                        <li>
                            <a href="../../../../stable/index.html">4.13.0.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-4.12.0.x/index.html">4.12.0.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="index.html">4.11.1.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-4.10.0.x/index.html">4.10.0.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-4.7.2.x/index.html">4.7.2.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-3.11.2.x/index.html">3.11.2.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-3.11.0.x/index.html">3.11.0.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-3.10.2.x/index.html">3.10.2.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-3.7.2.x/index.html">3.7.2.x</a>
                        </li>
                    
                
                
            </ul>
        </li>
    </ul>
</div>
        <div class="side-nav__content">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Java Driver for Scylla and Apache Cassandra®</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API Documentation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">Manual</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../api_conventions/index.html">API conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../case_sensitivity/index.html">Case sensitivity</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../core/index.html">Core driver</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../core/address_resolution/index.html">Address resolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/async/index.html">Asynchronous programming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/authentication/index.html">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/bom/index.html">Bill of Materials (BOM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/compression/index.html">Compression</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../core/configuration/index.html">Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../core/configuration/reference/README.html">Reference configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../core/control_connection/index.html">Control connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/custom_codecs/index.html">Custom codecs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/detachable_types/index.html">Detachable types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/idempotence/index.html">Query idempotence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/integration/index.html">Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/load_balancing/index.html">Load balancing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/logging/index.html">Logging</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../core/metadata/index.html">Metadata</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../core/metadata/node/index.html">Node metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../core/metadata/schema/index.html">Schema metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../core/metadata/token/index.html">Token metadata</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../core/metrics/index.html">Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/native_protocol/index.html">Native protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/non_blocking/index.html">Non-blocking programming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/paging/index.html">Paging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/performance/index.html">Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/pooling/index.html">Connection pooling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/query_timestamps/index.html">Query timestamps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/reactive/index.html">Reactive Style Programming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/reconnection/index.html">Reconnection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/request_tracker/index.html">Request tracker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/retries/index.html">Retries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/shaded_jar/index.html">Using the shaded JAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/speculative_execution/index.html">Speculative query execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/ssl/index.html">SSL</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../core/statements/index.html">Statements</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../core/statements/batch/index.html">Batch statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../core/statements/per_query_keyspace/index.html">Per-query keyspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../core/statements/prepared/index.html">Prepared statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../core/statements/simple/index.html">Simple statements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../core/temporal_types/index.html">Temporal types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/throttling/index.html">Request throttling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/tracing/index.html">Query tracing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/tuples/index.html">Tuples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/udts/index.html">User-defined types</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index.html">Developer docs</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../admin/index.html">Administrative tasks</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../common/index.html">Common infrastructure</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../common/concurrency/index.html">Concurrency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../common/context/index.html">Driver context</a></li>
<li class="toctree-l4"><a class="reference internal" href="../common/event_bus/index.html">Event bus</a></li>
</ul>
</li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Native protocol layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netty_pipeline/index.html">Netty pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../request_execution/index.html">Request execution</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../mapper/index.html">Mapper</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label for="toctree-checkbox-8"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../mapper/config/index.html">Integration</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label for="toctree-checkbox-9"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/config/kotlin/index.html">Kotlin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/config/lombok/index.html">Lombok</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/config/record/index.html">Java 14 Records</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/config/scala/index.html">Scala</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../mapper/daos/index.html">DAOs</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label for="toctree-checkbox-10"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/custom_types/index.html">Custom result types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/delete/index.html">Delete methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/getentity/index.html">GetEntity methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/increment/index.html">Increment methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/insert/index.html">Insert methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/null_saving/index.html">Null saving strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/query/index.html">Query methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/queryprovider/index.html">Query provider methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/select/index.html">Select methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/setentity/index.html">SetEntity methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/statement_attributes/index.html">Statement attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/update/index.html">Update methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../mapper/entities/index.html">Entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../mapper/mapper/index.html">Mapper interface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../osgi/index.html">OSGi</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../query_builder/index.html">Query builder</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label for="toctree-checkbox-11"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/condition/index.html">Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/delete/index.html">DELETE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/idempotence/index.html">Idempotence in the query builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/insert/index.html">INSERT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/relation/index.html">Relations</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../query_builder/schema/index.html">Schema builder</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label for="toctree-checkbox-12"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/aggregate/index.html">Aggregate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/function/index.html">Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/index/index.html">Index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/keyspace/index.html">Keyspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/materialized_view/index.html">Materialized View</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/table/index.html">Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/type/index.html">Type</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/select/index.html">SELECT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/term/index.html">Terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/truncate/index.html">TRUNCATE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/update/index.html">UPDATE</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../upgrade_guide/index.html">Upgrade guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog/index.html">Changelog</a></li>
</ul>

        </div>
    </div>
</div>
                    
                
            </div>
            
                <div class="sidebar-right large-order-3">
                    <div class="secondary-side-nav custom-scroll-bar">
    
    <ul class="contribute">
        <li class="contribute__item">
            <a href="https://github.com/scylladb/java-driver/issues/new?title=Issue in page Native protocol layer&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://java-driver.docs.scylladb.com/scylla-4.11.1.x/manual/developer/native_protocol/index%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix"
                target="_blank">
                <i class="icon fab fa-github" aria-hidden="true"></i>Create an issue
            </a>
        </li>
        
            <li class="contribute__item">
                
                
                    
                        
                    
                
                <a href="https://github.com/scylladb/java-driver/edit/scylla-4.11.1.x/docs/source/manual/developer/native_protocol/index.md"
                    target="_blank">
                    <i class="icon fa fa-edit" aria-hidden="true"></i>Edit this page
                </a>
            </li>
        
    </ul>

    
        <div class="secondary-side-nav__content">
            <p class="topic-title">On this page</p>
            <ul>
<li><a class="reference internal" href="#">Native protocol layer</a><ul>
<li><a class="reference internal" href="#native-protocol-types">Native protocol types</a><ul>
<li><a class="reference internal" href="#messages">Messages</a></li>
<li><a class="reference internal" href="#encoding-decoding">Encoding/decoding</a></li>
</ul>
</li>
<li><a class="reference internal" href="#integration-in-the-driver">Integration in the driver</a></li>
<li><a class="reference internal" href="#extension-points">Extension points</a></li>
</ul>
</li>
</ul>

        </div>
    
</div>
                </div>
            
        </section>

        <footer class="footer">
    <div class="footer-group">
        <div class="footer-top">
            <a class="footer-logo" href="https://www.scylladb.com">
                <img src="../../../_static/img/logo-scylla-horizontal-RGB.svg" alt="Logo" />
            </a>
            <div class="footer-links">
                <a class="footer-links__link" href="https://docs.scylladb.com/">Docs</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/">About Us</a>
            </div>
            <div class="footer-actions">
                <a class="footer-actions__link" href="https://groups.google.com/g/scylladb-users" target="_blank">
                    <span data-tooltip tabindex="1" title="User mailing list" data-position="bottom">
                        <img src="../../../_static/img/icons/icon-mail-list.svg" alt="Mail List Icon" />
                    </span>
                </a>
                <a class="footer-actions__link" href="http://slack.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="User Slack channel" data-position="bottom">
                        <img src="../../../_static/img/icons/icon-slack.svg" alt="Slack Icon" />
                    </span>
                </a>
            </div>
        </div>

        <div class="footer-bottom">
            
                <div class="footer-bottom__copyright">
                    
                        
                            &#169; 2022, ScyllaDB. All rights reserved.
                        
                    
                </div>
            
            
                <div class="footer-bottom__last-updated">
                    
                        Last updated on 25 May 2022.
                    
                </div>
            
            <div class="footer-bottom__version">
                Powered by
                <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a> &amp;
                <a href="https://sphinx-theme.scylladb.com/">ScyllaDB Theme 1.2.2</a>
            </div>
        </div>
    </div>
</footer>

        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP" height="0" width="0"
                style="display: none; visibility: hidden"></iframe>
        </noscript>
    </body>

</html>