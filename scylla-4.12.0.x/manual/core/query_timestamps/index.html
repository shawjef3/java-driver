

<!DOCTYPE html>
<html class="no-js" lang="en">
    
    

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>
             Query timestamps | Scylla Docs 
        </title>
        <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />
        <link rel="icon" href="../../../_static/img/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="../../../_static/img/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" href="../../../_static/img/favicon-228x228.png" sizes="192x192" />
        <link rel="apple-touch-icon" href="../../../_static/img/favicon-228x228.png" />
        <meta name="msapplication-TileImage" href="../../../_static/img/favicon-228x228.png" />

        
            
        

        
            
            <link rel="canonical" href="https://java-driver.docs.scylladb.com/stable/manual/core/query_timestamps/"/>
        

        <link rel="author" href="mailto:info@scylladb.com" />

        
            
        <!-- increase expertrec loading priority-->
        <link rel="dns-prefetch" href="https://cse.expertrec.com">

        <!-- increase font loading priority -->
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="preload" as="style"
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- async CSS -->
        <link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');"
            href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- no-JS fallback -->
        <noscript>
            <link rel="stylesheet"
                href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />
        </noscript>
        
            
                <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../../../_static/css/main.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../../../_static/sphinx_collapse.css" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
            
        
    
        
        
            

        <script type="text/javascript" id="documentation_options" data-url_root="../../../"
            src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/js/runtime.bundle.js"></script>
        <script type="text/javascript" src="../../../_static/js/main.bundle.js"></script>
        
            
                <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
            
        
            
        
            
                <script src="../../../_static/underscore.js"></script>
            
        
            
                <script src="../../../_static/doctools.js"></script>
            
        
            
                <script src="../../../_static/clipboard.min.js"></script>
            
        
            
                <script src="../../../_static/copybutton.js"></script>
            
        
    
            <!-- Google Tag Manager -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-T8P2JP");
</script>
<!-- End Google Tag Manager -->

<!-- Expertrec -->
<script>
    var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
    var ci_search = document.createElement("script");
    ci_search.type = "text/javascript";
    ci_search.async = true;
    ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ci_search, s);
</script>
<!-- End Expertrec -->
        
        <!-- Font Awesome -->
        <script src="https://kit.fontawesome.com/b1870adf6a.js" crossorigin="anonymous"></script>
        <!-- End Font Awesome -->
    </head>

    <body>
        
        <header class="header">
    <div class="header-logo">
        <a class="header-logo__img" href="https://scylladb.com/">
            <img src="../../../_static/img/logo-docs.svg" alt="Scylla Documentation Logo" />
        </a>
        <span class="header-logo__bar"></span>
        <a class="header-logo__text" href="https://docs.scylladb.com/">
            Documentation
        </a>
    </div>
    <div class="header-navigation">
        <ul class="dropdown menu scylla-dropdown scylla-dropdown--header" data-dropdown-menu>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Server
                    <i class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--about-us"></i>
                            Scylla Open Source
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--enterprise"></i>Scylla Enterprise
                        </a>
                    </li>
                    <li>
                        <a href="https://scylla.docs.scylladb.com/stable/alternator/alternator.html">
                            <i class="scylla-icon scylla-icon--overview"></i>
                            Scylla Alternator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Cloud <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://cloud.scylladb.com/">
                            <i class="scylla-icon scylla-icon--cloud"></i>Scylla Cloud</a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">
                            <i class="scylla-icon scylla-icon--cloud-docs"></i>Scylla Cloud
                            Docs</a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Tools <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://manager.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--manager"></i>Scylla Manager</a>
                    </li>
                    <li>
                        <a href="https://monitoring.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--monitoring"></i>Scylla
                            Monitoring Stack</a>
                    </li>
                    <li>
                        <a href="https://operator.docs.scylladb.com/">
                            <i class="scylla-icon scylla-icon--operator"></i>Scylla Operator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Drivers <i
                    class="chevron scylla-icon scylla-icon--triangle-down"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/cql-drivers/">
                            <i class="scylla-icon scylla-icon--nsql-guides"></i>CQL Drivers
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/dynamo-drivers/">
                            <i class="scylla-icon scylla-icon--overview"></i>DynamoDB Drivers
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
        <div class="header-button">
            <a href="https://www.scylladb.com/download/" class="button">Download</a>
        </div>
    </div>
    <div class="header-search-box">
        <div class="search-box">
            <ci-search></ci-search>
        </div>
    </div>
    <div class="side-nav-toggle" data-toggle="side-nav">
    <div class="side-nav-toggle__button">
        <img src="../../../_static/img/menu.svg" alt="Menu" />
    </div>
</div>
</header>
        <section
            class="layout  layout--sidebar layout--has-secondary-sidebar ">
            <div class="content large-order-2">
                
                    
    <div class="admonition caution">
        <p class="admonition-title">Caution</p>
        <p>
            
                You're viewing documentation for a previous version of Scylla Java Driver.
            
            <a href="../../../../stable/index.html">Switch to the latest stable version.</a>
        </p>
    </div>

                
                
                    <div class="pre-content">
                        <div class="breadcrumbs">
    <span class="bread__item">
        <a href="https://java-driver.docs.scylladb.com"
            class="bread__highlight">
            <i class="fas fa-home"></i> Scylla Java Driver
        </a>
    </span>
    
        <span class="bread__item">
            <a href="../../index.html">
                Manual
            </a>
        </span>
    
        <span class="bread__item">
            <a href="../index.html">
                Core driver
            </a>
        </span>
    
    <span class="bread__item bread__item--last">Query timestamps</span>
</div>
                    </div>
                
                <section id="query-timestamps">
<h1>Query timestamps<a class="headerlink" href="#query-timestamps" title="Permalink to this headline">¶</a></h1>
<section id="quick-overview">
<h2>Quick overview<a class="headerlink" href="#quick-overview" title="Permalink to this headline">¶</a></h2>
<p>Defines the order in which mutations are applied on the server. Ways to set it (by order of
precedence, higher priority first):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">USING</span> <span class="pre">TIMESTAMP</span></code> in the query string.</p></li>
<li><p>programmatically with <a class="reference external" href="https://java-driver.docs.scylladb.com/scylla-4.12.0.x/api/com/datastax/oss/driver/api/core/cql/Statement.html#setQueryTimestamp-long-">Statement.setQueryTimestamp()</a>.</p></li>
<li><p>timestamp generator: <code class="docutils literal notranslate"><span class="pre">advanced.timestamp-generator</span></code> in the configuration. Defaults to session-wide
monotonic, also available: per-thread monotonic, server-side, or write your own.</p></li>
<li><p>if the generator didn’t set it, assigned server-side.</p></li>
</ul>
<hr class="docutils" />
<p>In Cassandra, each mutation has a microsecond-precision timestamp, which is used to order operations
relative to each other.</p>
<p>There are various ways to assign it:</p>
</section>
<section id="cql-using-timestamp">
<h2>CQL <code class="docutils literal notranslate"><span class="pre">USING</span> <span class="pre">TIMESTAMP</span></code><a class="headerlink" href="#cql-using-timestamp" title="Permalink to this headline">¶</a></h2>
<p>You can explicitly provide the timestamp in your CQL query:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">&quot;INSERT INTO my_table(c1, c2) values (1, 1) &quot;</span> <span class="o">+</span>
    <span class="s">&quot;USING TIMESTAMP 1432815430948040&quot;</span><span class="o">);</span>
</pre></div>
</div>
</section>
<section id="timestamp-generator">
<h2>Timestamp generator<a class="headerlink" href="#timestamp-generator" title="Permalink to this headline">¶</a></h2>
<p>The driver has a timestamp generator that gets invoked for every outgoing request; it either assigns
a client-side timestamp to the request, or indicates that the server should assign it.</p>
<p>The timestamp generator is defined in the <a class="reference external" href="../configuration/">configuration</a>.</p>
<section id="atomictimestampgenerator">
<h3>AtomicTimestampGenerator<a class="headerlink" href="#atomictimestampgenerator" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>datastax-java-driver.advanced.timestamp-generator {
  class = AtomicTimestampGenerator
}
</pre></div>
</div>
<p>This is the default implementation. It always generates a client timestamp, and guarantees
monotonicity (i.e. ever-increasing timestamps) across all application threads.</p>
<p>Note that, in order to achieve monotonicity, the generator might return timestamps that drift out in
the future. This happens if timestamps are generated at a rate of more than one per microsecond, or
more likely in the event of a system clock skew. When this happens, the generator logs a warning
message in the category <code class="docutils literal notranslate"><span class="pre">com.datastax.oss.driver.internal.core.time.MonotonicTimestampGenerator</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Clock</span> <span class="n">skew</span> <span class="n">detected</span><span class="p">:</span> <span class="n">current</span> <span class="n">tick</span> <span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="n">was</span> <span class="o">...</span> <span class="n">microseconds</span> <span class="n">behind</span> <span class="n">the</span> <span class="n">last</span> <span class="n">generated</span> <span class="n">timestamp</span> <span class="p">(</span><span class="o">...</span><span class="p">),</span>
<span class="n">returned</span> <span class="n">timestamps</span> <span class="n">will</span> <span class="n">be</span> <span class="n">artificially</span> <span class="n">incremented</span> <span class="n">to</span> <span class="n">guarantee</span> <span class="n">monotonicity</span><span class="o">.</span>
</pre></div>
</div>
<p>You can control that message with these options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">datastax</span><span class="o">-</span><span class="n">java</span><span class="o">-</span><span class="n">driver</span><span class="o">.</span><span class="n">advanced</span><span class="o">.</span><span class="n">timestamp</span><span class="o">-</span><span class="n">generator</span> <span class="p">{</span>
  <span class="n">drift</span><span class="o">-</span><span class="n">warning</span> <span class="p">{</span>
    <span class="c1"># How far in the future timestamps are allowed to drift before the warning is logged.</span>
    <span class="c1"># If it is undefined or set to 0, warnings are disabled.</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">second</span>
    <span class="c1"># How often the warning will be logged if timestamps keep drifting above the threshold.</span>
    <span class="n">interval</span> <span class="o">=</span> <span class="mi">10</span> <span class="n">seconds</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This generator strives to achieve microsecond resolution on a best-effort basis. But in practice,
the real accuracy of generated timestamps is largely dependent on the granularity of the operating
system’s clock. For most systems, this minimum granularity is millisecond, and the sub-millisecond
part is simply a counter that gets incremented until the next clock tick, as provided by
<code class="docutils literal notranslate"><span class="pre">System.currentTimeMillis()</span></code>.</p>
<p>On some systems, however, it is possible to have a better granularity by using a <a class="reference external" href="https://github.com/jnr/jnr-posix">JNR</a> call to
<a class="reference external" href="http://man7.org/linux/man-pages/man2/settimeofday.2.html">gettimeofday</a>. This native call will be used when available, unless use of the Java clock is forced
with this configuration option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">datastax</span><span class="o">-</span><span class="n">java</span><span class="o">-</span><span class="n">driver</span><span class="o">.</span><span class="n">advanced</span><span class="o">.</span><span class="n">timestamp</span><span class="o">-</span><span class="n">generator</span> <span class="p">{</span>
  <span class="n">force</span><span class="o">-</span><span class="n">java</span><span class="o">-</span><span class="n">clock</span> <span class="o">=</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To check what the driver is currently using, turn on <code class="docutils literal notranslate"><span class="pre">INFO</span></code> logs for the category
<code class="docutils literal notranslate"><span class="pre">com.datastax.oss.driver.internal.core.time</span></code>, and look for one of the following messages at
initialization:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Using</span> <span class="pre">Java</span> <span class="pre">system</span> <span class="pre">clock</span> <span class="pre">because</span> <span class="pre">this</span> <span class="pre">was</span> <span class="pre">explicitly</span> <span class="pre">required</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">configuration</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Could</span> <span class="pre">not</span> <span class="pre">access</span> <span class="pre">native</span> <span class="pre">clock</span> <span class="pre">(see</span> <span class="pre">debug</span> <span class="pre">logs</span> <span class="pre">for</span> <span class="pre">details),</span> <span class="pre">falling</span> <span class="pre">back</span> <span class="pre">to</span> <span class="pre">Java</span> <span class="pre">system</span> <span class="pre">clock</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Using</span> <span class="pre">native</span> <span class="pre">clock</span> <span class="pre">for</span> <span class="pre">microsecond</span> <span class="pre">precision</span></code></p></li>
</ul>
</section>
<section id="threadlocaltimestampgenerator">
<h3>ThreadLocalTimestampGenerator<a class="headerlink" href="#threadlocaltimestampgenerator" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>datastax-java-driver.advanced.timestamp-generator {
  class = ThreadLocalTimestampGenerator
}
</pre></div>
</div>
<p>This is similar to the atomic generator, except that it only guarantees monotonicity within each
thread. In other words, if a given application thread invokes <code class="docutils literal notranslate"><span class="pre">session.execute()</span></code> multiple times,
the timestamps will be strictly increasing; but across two or more application threads, there might
be duplicates.</p>
<p>This is a bit more efficient, but should only be used when threads are not in direct competition for
timestamp ties (i.e., they are executing independent statements).</p>
<p>It uses the same configuration options <code class="docutils literal notranslate"><span class="pre">drift-warning</span></code> and<code class="docutils literal notranslate"><span class="pre">force-java-clock</span></code>; see the previous
section for details.</p>
</section>
<section id="serversidetimestampgenerator">
<h3>ServerSideTimestampGenerator<a class="headerlink" href="#serversidetimestampgenerator" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>datastax-java-driver.advanced.timestamp-generator {
  class = ServerSideTimestampGenerator
}
</pre></div>
</div>
<p>This implementation always lets the server assign a timestamp.</p>
</section>
<section id="custom">
<h3>Custom<a class="headerlink" href="#custom" title="Permalink to this headline">¶</a></h3>
<p>You can create your own generator by implementing <a class="reference external" href="https://java-driver.docs.scylladb.com/scylla-4.12.0.x/api/com/datastax/oss/driver/api/core/time/TimestampGenerator.html">TimestampGenerator</a>, and referencing your
implementation class from the configuration.</p>
</section>
<section id="using-multiple-generators">
<h3>Using multiple generators<a class="headerlink" href="#using-multiple-generators" title="Permalink to this headline">¶</a></h3>
<p>The timestamp generator can be overridden in <a class="reference external" href="../configuration/#profiles">execution profiles</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>datastax-java-driver {
  advanced.timestamp-generator.class = AtomicTimestampGenerator
  profiles {
    profile1 {
      advanced.timestamp-generator.class = ServerSideTimestampGenerator
    }
    profile2 {}
  } 
}
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">profile1</span></code> profile uses its own generator. The <code class="docutils literal notranslate"><span class="pre">profile2</span></code> profile inherits the default
profile’s. Note that this goes beyond configuration inheritance: the driver only creates a single
<code class="docutils literal notranslate"><span class="pre">AtomicTimestampGenerator</span></code> instance and reuses it (this also occurs if two sibling profiles have the
same configuration).</p>
<p>Each request uses its declared profile’s generator. If it doesn’t declare any profile, or if the
profile doesn’t have a dedicated policy, then the default profile’s generator is used.</p>
</section>
</section>
<section id="per-statement-timestamp">
<h2>Per-statement timestamp<a class="headerlink" href="#per-statement-timestamp" title="Permalink to this headline">¶</a></h2>
<p>Finally, you can assign a timestamp to a statement directly from application code:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Statement</span> <span class="n">statement</span> <span class="o">=</span>
    <span class="n">SimpleStatement</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="s">&quot;UPDATE users SET email = &#39;x@y.com&#39; where id = 1&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setQueryTimestamp</span><span class="o">(</span><span class="mi">1432815430948040L</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="n">session</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">statement</span><span class="o">);</span>
</pre></div>
</div>
</section>
<section id="timestamps-and-lightweight-transactions">
<h2>Timestamps and lightweight transactions<a class="headerlink" href="#timestamps-and-lightweight-transactions" title="Permalink to this headline">¶</a></h2>
<p>Client-side timestamps are prohibited for <a class="reference external" href="https://docs.datastax.com/en/dse/6.0/cql/cql/cql_using/useInsertLWT.html">lightweight transactions</a> (used for conditional updates
such as <code class="docutils literal notranslate"><span class="pre">INSERT...</span> <span class="pre">IF</span> <span class="pre">NOT</span> <span class="pre">EXISTS</span></code>, <code class="docutils literal notranslate"><span class="pre">UPDATE...</span> <span class="pre">IF...</span></code>, etc.).</p>
<p>If you add a <code class="docutils literal notranslate"><span class="pre">USING</span> <span class="pre">TIMESTAMP</span></code> clause to such a query, the server will return an error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cqlsh</span><span class="o">&gt;</span> <span class="n">UPDATE</span> <span class="n">foo</span> <span class="n">USING</span> <span class="n">TIMESTAMP</span> <span class="mi">1234</span> <span class="n">SET</span> <span class="n">v</span><span class="o">=</span><span class="mi">1</span> <span class="n">WHERE</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span> <span class="n">IF</span> <span class="n">v</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="n">InvalidRequest</span><span class="p">:</span> <span class="n">Error</span> <span class="kn">from</span> <span class="nn">server</span><span class="p">:</span> <span class="n">code</span><span class="o">=</span><span class="mi">2200</span> <span class="p">[</span><span class="n">Invalid</span> <span class="n">query</span><span class="p">]</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Cannot provide custom timestamp for conditional updates&quot;</span>
</pre></div>
</div>
<p>If you execute a conditional update through the driver with a client-side timestamp generator, the
client-side timestamp will be silently ignored and the server will provide its own.</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Here is the order of precedence of all the methods described so far:</p>
<ol class="simple">
<li><p>if there is a <code class="docutils literal notranslate"><span class="pre">USING</span> <span class="pre">TIMESTAMP</span></code> clause in the CQL string, use that over anything else;</p></li>
<li><p>otherwise, if a default timestamp was set directly on the statement, use it;</p></li>
<li><p>otherwise, if the timestamp generator assigned a timestamp, use it;</p></li>
<li><p>otherwise, let the server assign the timestamp.</p></li>
</ol>
</section>
</section>

                
                    <div class="post-content"><div class="content-navigation">
    <div class="navigation navigation--prev">
        
            <a class="navigation__link" href="../pooling/index.html">
                <button class="navigation__button">
                    <i class="scylla-icon scylla-icon--chevron-left"></i>
                </button>
                <div class="navigation__title">
                    <span class="colored">PREVIOUS</span> <br />Connection pooling
                </div>
            </a>
        
    </div>
    <div class="navigation navigation--next">
        
            <a class="navigation__link" href="../reactive/index.html">
                <div class="navigation__title">
                    <span class="colored">NEXT</span> <br />Reactive Style Programming
                </div>
                <button class="navigation__button">
                    <i class="scylla-icon scylla-icon--chevron-right"></i>
                </button>
            </a>
        
    </div>
</div></div>
                
            </div>
            <div class="sidebar-left  large-order-1">
                
                    
                        <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
    <button class="collapsible-button">
        <i class="scylla-icon scylla-icon--chevron-left"></i>
    </button>
    <div class="side-nav-content">
        <div class="side-nav__search">
            <div class="search-box">
                <ci-search></ci-search>
            </div>
        </div>
        <div class="side-nav__versions">
    <ul class="dropdown menu scylla-dropdown scylla-dropdown--versions" data-dropdown-menu>
        <li class="scylla-dropdown__item">
            <a class="scylla-dropdown__title" href="#">
                
                    4.12.0.x
                
                <i class="chevron scylla-icon scylla-icon--chevron-right"></i>
            </a>
            <ul class="menu scylla-dropdown__content">
                
                    
                        <li>
                            <a href="../../../../stable/index.html">4.13.0.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="index.html">4.12.0.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-4.11.1.x/index.html">4.11.1.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-4.10.0.x/index.html">4.10.0.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-4.7.2.x/index.html">4.7.2.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-3.11.2.x/index.html">3.11.2.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-3.11.0.x/index.html">3.11.0.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-3.10.2.x/index.html">3.10.2.x</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="../../../../scylla-3.7.2.x/index.html">3.7.2.x</a>
                        </li>
                    
                
                
            </ul>
        </li>
    </ul>
</div>
        <div class="side-nav__content">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Java Driver for Scylla and Apache Cassandra®</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API Documentation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">Manual</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../api_conventions/index.html">API conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../case_sensitivity/index.html">Case sensitivity</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index.html">Core driver</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../address_resolution/index.html">Address resolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../async/index.html">Asynchronous programming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../authentication/index.html">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bom/index.html">Bill of Materials (BOM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../compression/index.html">Compression</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/index.html">Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/reference/README.html">Reference configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../control_connection/index.html">Control connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../custom_codecs/index.html">Custom codecs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../detachable_types/index.html">Detachable types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../idempotence/index.html">Query idempotence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration/index.html">Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../load_balancing/index.html">Load balancing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../logging/index.html">Logging</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../metadata/index.html">Metadata</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../metadata/node/index.html">Node metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/schema/index.html">Schema metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/token/index.html">Token metadata</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../metrics/index.html">Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../native_protocol/index.html">Native protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../non_blocking/index.html">Non-blocking programming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../paging/index.html">Paging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../performance/index.html">Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pooling/index.html">Connection pooling</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Query timestamps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reactive/index.html">Reactive Style Programming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reconnection/index.html">Reconnection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../request_tracker/index.html">Request tracker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../retries/index.html">Retries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shaded_jar/index.html">Using the shaded JAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../speculative_execution/index.html">Speculative query execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ssl/index.html">SSL</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../statements/index.html">Statements</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../statements/batch/index.html">Batch statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statements/per_query_keyspace/index.html">Per-query keyspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statements/prepared/index.html">Prepared statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statements/simple/index.html">Simple statements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../temporal_types/index.html">Temporal types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../throttling/index.html">Request throttling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/index.html">Query tracing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tuples/index.html">Tuples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../udts/index.html">User-defined types</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../developer/index.html">Developer docs</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developer/admin/index.html">Administrative tasks</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../developer/common/index.html">Common infrastructure</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../developer/common/concurrency/index.html">Concurrency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../developer/common/context/index.html">Driver context</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../developer/common/event_bus/index.html">Event bus</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../developer/native_protocol/index.html">Native protocol layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer/netty_pipeline/index.html">Netty pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer/request_execution/index.html">Request execution</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../mapper/index.html">Mapper</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label for="toctree-checkbox-8"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../mapper/config/index.html">Integration</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label for="toctree-checkbox-9"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/config/kotlin/index.html">Kotlin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/config/lombok/index.html">Lombok</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/config/record/index.html">Java 14 Records</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/config/scala/index.html">Scala</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../mapper/daos/index.html">DAOs</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label for="toctree-checkbox-10"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/custom_types/index.html">Custom result types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/delete/index.html">Delete methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/getentity/index.html">GetEntity methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/increment/index.html">Increment methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/insert/index.html">Insert methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/null_saving/index.html">Null saving strategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/query/index.html">Query methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/queryprovider/index.html">Query provider methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/select/index.html">Select methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/setentity/index.html">SetEntity methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/statement_attributes/index.html">Statement attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mapper/daos/update/index.html">Update methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../mapper/entities/index.html">Entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../mapper/mapper/index.html">Mapper interface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../osgi/index.html">OSGi</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../query_builder/index.html">Query builder</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label for="toctree-checkbox-11"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/condition/index.html">Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/delete/index.html">DELETE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/idempotence/index.html">Idempotence in the query builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/insert/index.html">INSERT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/relation/index.html">Relations</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../query_builder/schema/index.html">Schema builder</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label for="toctree-checkbox-12"><i class="scylla-icon scylla-icon--expand"></i></label><div class="break"></div><ul>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/aggregate/index.html">Aggregate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/function/index.html">Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/index/index.html">Index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/keyspace/index.html">Keyspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/materialized_view/index.html">Materialized View</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/table/index.html">Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_builder/schema/type/index.html">Type</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/select/index.html">SELECT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/term/index.html">Terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/truncate/index.html">TRUNCATE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_builder/update/index.html">UPDATE</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../upgrade_guide/index.html">Upgrade guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/index.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog/index.html">Changelog</a></li>
</ul>

        </div>
    </div>
</div>
                    
                
            </div>
            
                <div class="sidebar-right large-order-3">
                    <div class="secondary-side-nav custom-scroll-bar">
    
    <ul class="contribute">
        <li class="contribute__item">
            <a href="https://github.com/scylladb/java-driver/issues/new?title=Issue in page Query timestamps&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20https://java-driver.docs.scylladb.com/scylla-4.12.0.x/manual/core/query_timestamps/index%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix"
                target="_blank">
                <i class="icon fab fa-github" aria-hidden="true"></i>Create an issue
            </a>
        </li>
        
            <li class="contribute__item">
                
                
                    
                        
                    
                
                <a href="https://github.com/scylladb/java-driver/edit/scylla-4.12.0.x/docs/source/manual/core/query_timestamps/index.md"
                    target="_blank">
                    <i class="icon fa fa-edit" aria-hidden="true"></i>Edit this page
                </a>
            </li>
        
    </ul>

    
        <div class="secondary-side-nav__content">
            <p class="topic-title">On this page</p>
            <ul>
<li><a class="reference internal" href="#">Query timestamps</a><ul>
<li><a class="reference internal" href="#quick-overview">Quick overview</a></li>
<li><a class="reference internal" href="#cql-using-timestamp">CQL <code class="docutils literal notranslate"><span class="pre">USING</span> <span class="pre">TIMESTAMP</span></code></a></li>
<li><a class="reference internal" href="#timestamp-generator">Timestamp generator</a><ul>
<li><a class="reference internal" href="#atomictimestampgenerator">AtomicTimestampGenerator</a></li>
<li><a class="reference internal" href="#threadlocaltimestampgenerator">ThreadLocalTimestampGenerator</a></li>
<li><a class="reference internal" href="#serversidetimestampgenerator">ServerSideTimestampGenerator</a></li>
<li><a class="reference internal" href="#custom">Custom</a></li>
<li><a class="reference internal" href="#using-multiple-generators">Using multiple generators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#per-statement-timestamp">Per-statement timestamp</a></li>
<li><a class="reference internal" href="#timestamps-and-lightweight-transactions">Timestamps and lightweight transactions</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
</ul>

        </div>
    
</div>
                </div>
            
        </section>

        <footer class="footer">
    <div class="footer-group">
        <div class="footer-top">
            <a class="footer-logo" href="https://www.scylladb.com">
                <img src="../../../_static/img/logo-scylla-horizontal-RGB.svg" alt="Logo" />
            </a>
            <div class="footer-links">
                <a class="footer-links__link" href="https://docs.scylladb.com/">Docs</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/">About Us</a>
            </div>
            <div class="footer-actions">
                <a class="footer-actions__link" href="https://groups.google.com/g/scylladb-users" target="_blank">
                    <span data-tooltip tabindex="1" title="User mailing list" data-position="bottom">
                        <img src="../../../_static/img/icons/icon-mail-list.svg" alt="Mail List Icon" />
                    </span>
                </a>
                <a class="footer-actions__link" href="http://slack.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="User Slack channel" data-position="bottom">
                        <img src="../../../_static/img/icons/icon-slack.svg" alt="Slack Icon" />
                    </span>
                </a>
            </div>
        </div>

        <div class="footer-bottom">
            
                <div class="footer-bottom__copyright">
                    
                        
                            &#169; 2022, ScyllaDB. All rights reserved.
                        
                    
                </div>
            
            
                <div class="footer-bottom__last-updated">
                    
                        Last updated on 25 May 2022.
                    
                </div>
            
            <div class="footer-bottom__version">
                Powered by
                <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a> &amp;
                <a href="https://sphinx-theme.scylladb.com/">ScyllaDB Theme 1.2.2</a>
            </div>
        </div>
    </div>
</footer>

        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP" height="0" width="0"
                style="display: none; visibility: hidden"></iframe>
        </noscript>
    </body>

</html>